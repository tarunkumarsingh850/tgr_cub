<odoo>
  <data>

    <record id="account_move_vendor_code_inherit" model="ir.ui.view">
      <field name="name">account.move.view.form.inherit.vendor.code</field>
      <field name="model">account.move</field>
      <field name="inherit_id" ref="account.view_in_invoice_bill_tree"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='invoice_partner_display_name']" position="after">
          <field name="code_vendor" string="Vendor ID"/>
        </xpath>
        <xpath expr="//field[@name='ref']" position="after">
          <field name="partner_vat"/>
        </xpath>

      </field>
    </record>

    <record id="account_move_vendor_code_invoice_inherit" model="ir.ui.view">
      <field name="name">account.move.view.invoice.inherit.vendor.code</field>
      <field name="model">account.move</field>
      <field name="inherit_id" ref="account.view_out_invoice_tree"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='invoice_date']" position="before">
            <field name="partner_state_id"/>
            <field name="code_customer" string="Customer ID"/>
            <field name="warehouse_id"/>
            <field name="picking_id"/>
            <field name="picking_date"/>
            <field name="partner_country_id"/>
            <field name="magento_website_id"/>
            <field name="partner_vat"/>
        </xpath>
      </field>
    </record>

  <record id="account_move_invoice_inherit_form_view_new" model="ir.ui.view">
      <field name="name">account.move.view.invoice.inherit.form.view.new</field>
      <field name="model">account.move</field>
      <field name="inherit_id" ref="account.view_move_form"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='edi_state']" position="after">
          <field name="edi_mark_as_sent" groups="bi_accounting_generic_customization.edi_mark_as_sent_access" attrs="{'invisible':[('move_type','=','entry')]}"/>
          <field name="is_invoice_mail_send" string="Email Send" readonly="True"/>
        </xpath>
        <xpath expr="//label[@for='invoice_payment_term_id']" position="replace">
             <field name="invoice_payment_term_id" invisible="1"/>
        </xpath>
        <xpath expr="//div[hasclass('d-flex')]" position="replace">
            <field name="invoice_date_due" force_save="1" placeholder="Date"/>
            <field name="invoice_payment_term_id" placeholder="Terms"/>
            <field name="is_accumilative_invoice" attrs="{'invisible':[('move_type','!=','out_invoice')]}"/>
            <field name="initial_series" attrs="{'invisible':[('is_accumilative_invoice','=',False)]}"/>
            <field name="final_series" attrs="{'invisible':[('is_accumilative_invoice','=',False)]}"/>
            <field name="is_service_bill" attrs="{'invisible':[('move_type','!=','in_invoice')]}"/>
          </xpath>
        <xpath expr="//group[@name='sale_info_group']" position="inside">
            <field name="warehouse_id"/>
            <field name="picking_id"/>
            <field name="picking_date"/>
            <field name="partner_country_id"/>
            <field name="magento_website_id"/>
            <field name="is_uk" invisible="1"/>
            <field name="is_spain" invisible="1"/>
        </xpath>
        <xpath expr="//field[@name='invoice_date']" position="after">
          <field name="l10n_es_registration_date" attrs="{'invisible':[('move_type','=','entry')], 'readonly':[('state','in',['posted','cancel'])]}"/>
          <field name="receipt_date" attrs="{'invisible': [('move_type', '!=', 'in_invoice')]}"/>
        </xpath>
        <xpath expr="//field[@name='payment_reference']" position="after">
          <field name="original_invoice_id" id="original_invoice" string="Original Invoice" domain ="[('move_type', '=', 'out_invoice'), ('state','=','posted')]" attrs="{'invisible':[('move_type','not in',['out_refund'])]}"/>
          <!-- <field name="original_invoice_id" id="original_bill" string="Original Bill" attrs="{'invisible':[('move_type','not in',['in_refund'])]}"/> -->
          <field name="original_bill_id" id="original_bill" string="Original Bill" domain ="[('move_type', '=', 'in_invoice'), ('state','=','posted')]" attrs="{'invisible':[('move_type','not in',['in_refund'])]}"/>
          <field name="original_invoice_date" string="Original Date" attrs="{'invisible':[('move_type','not in',['out_refund','in_refund'])]}"/>
          <field name="original_invoice_untaxed_amount" string="Original Amount" attrs="{'invisible':[('move_type','not in',['out_refund','in_refund'])]}"/>
        </xpath>
        <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='intrastat_transaction_id']" position="attributes">
          <attribute name="optional">hide</attribute>
        </xpath>
        <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='name']" position="after">
          <field name="product_sku" attrs="{'column_invisible': [('parent.move_type', '=', 'entry')]}"/>
        </xpath>
        <xpath expr="//field[@name='partner_bank_id']" position="after">
          <field name="analytic_account_id" attrs="{'invisible': [('move_type', '!=', 'in_invoice')]}"/>
          <field name="analytic_tag_ids" attrs="{'invisible': [('move_type', '!=', 'in_invoice')]}" widget="many2many_tags"/>
        </xpath>
        <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='quantity']" position="after">
          <field name="pack_size"/>
        </xpath>
      </field>
    </record>

    <record id="account_move_invoice_inherit_search_view" model="ir.ui.view">
      <field name="name">account.move.view.invoice.inherit.search.view</field>
      <field name="model">account.move</field>
      <field name="inherit_id" ref="account.view_account_invoice_filter"/>
      <field name="arch" type="xml">
        <xpath expr="//filter[@name='duedate']" position="after">
          <field name="picking_id" />
          <filter string="Warehouse" name="warehouse" context="{'group_by': 'warehouse_id'}"/>
          <filter string="Stock Transfer" name="stock_transfer" context="{'group_by': 'picking_id'}"/>
          <filter string="Stock Transfer Date" name="stock_transfer_date" context="{'group_by': 'picking_date'}"/>
          <filter string="Country" name="partner_country" context="{'group_by': 'partner_country_id'}"/>
          <filter string="Website" name="magento_website" context="{'group_by': 'magento_website_id'}"/>
        </xpath>
        <xpath expr="//filter[@name='cancel']" position="after">
          <separator/>
          <filter string="To Be Reported To HMRC" name="is_spain" domain="[('is_uk', '=', True),('state', '=', 'posted')]"/>
          <filter string="To Be Reported To SII" name="is_uk" domain="[('is_spain', '=', True),('edi_state', '=', 'to_send'),('state', '=', 'posted')]"/>
        </xpath>
      </field>
    </record>

    <record id="account_edi_inherit_sii_view_form" model="ir.ui.view">
      <field name="name">account.edi.inherit.sii.view.form</field>
      <field name="model">account.move</field>
      <field name="inherit_id" ref="account_edi.view_move_form_inherit"/>
      <field name="arch" type="xml">
        <xpath expr="//button[@name='button_process_edi_web_services']" position="attributes">
          <attribute name="groups">account.group_account_manager</attribute>
        </xpath>
      </field>
    </record>

    <record id="compute_picking_date" model="ir.actions.server">
      <field name="name">Compute Picking Date</field>
      <field name="model_id" ref="account.model_account_move"/>
      <field name="binding_model_id" ref="account.model_account_move"/>
      <field name="state">code</field>
      <field name="code">records._compute_picking_date()</field>
    </record>

    <record id="compute_picking_details" model="ir.actions.server">
      <field name="name">Compute Picking Details</field>
      <field name="model_id" ref="account.model_account_move"/>
      <field name="binding_model_id" ref="account.model_account_move"/>
      <field name="state">code</field>
      <field name="code">records._compute_picking_details()</field>
    </record>

    <record id="post_invoice_based_on_picking" model="ir.actions.server">
      <field name="name">Post Invoice by Picking</field>
      <field name="model_id" ref="account.model_account_move"/>
      <field name="binding_model_id" ref="account.model_account_move"/>
      <field name="state">code</field>
      <field name="code">records._post_invoice_based_on_picking()</field>
    </record>


    <record id="account_move_reversal_view_form" model="ir.ui.view">
      <field name="name">account.move.reversal.view.form</field>
      <field name="model">account.move.reversal</field>
      <field name="inherit_id" ref="account.view_account_move_reversal"/>
      <field name="arch" type="xml">
        <xpath expr="/form/group/group[1]" position="attributes">
          <attribute name="attrs">{'invisible': [('move_type', 'not in', ('out_invoice', 'in_invoice'))]}</attribute>
        </xpath>
        <xpath expr="/form/group/group[2]" position="attributes">
          <attribute name="attrs">{'invisible': [('move_type', 'not in', ('out_invoice', 'in_invoice', 'some_invoice'))]}</attribute>
        </xpath>
        <xpath expr="//field[@name='refund_method']" position="attributes">
          <attribute name="attrs"></attribute>
        </xpath>
      </field>
    </record>

    <record id="action_mark_as_sent" model="ir.actions.server">
      <field name="name">Mark As Sent</field>
      <field name="model_id" ref="account.model_account_move"/>
      <field name="binding_model_id" ref="account.model_account_move"/>
      <field name="state">code</field>
      <field name="code">records._action_mark_as_sent()</field>
    </record>


    <record id="action_all_siic_bills" model="ir.actions.act_window">
            <field name="name">All SII Invoice/ Vendor Bills</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.move</field>
            <field name="domain">[('edi_state','=','to_send'),('move_type','!=','entry')]</field>
            <field name="view_mode">tree,form</field>
        </record>

    <menuitem
        id="all_siic_bills"
        name="All SII Invoice/ Vendor Bills"
        action='action_all_siic_bills'
        parent="account.menu_finance_reports"
        sequence='99'
    />

    <record id="account.menu_action_account_moves_all" model="ir.ui.menu">
      <field name="groups_id" eval="[(6, 0, [])]"/>
    </record>

    <record id="view_account_move_line_filter_inherit" model="ir.ui.view">
      <field name="name">account.move.line.search.inherit</field>
      <field name="model">account.move.line</field>
      <field name="inherit_id" ref="account.view_account_move_line_filter" />
      <field name="arch" type="xml">
          <filter name="groupby_date" position="after">
            <filter string="Customer Class" name="groupby_customer_class_id" domain="[]" context="{'group_by': 'customer_class_id'}"/>
            <filter string="Customer Class" name="groupby_salesperson_partner_id" domain="[]" context="{'group_by': 'salesperson_partner_id'}"/>
          </filter>
      </field>
  </record>

  </data>
</odoo>
